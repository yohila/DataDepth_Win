from ddalpha import *

mat1=[[1, 0, 0],[0, 2, 0],[0, 0, 1]]
mat2=[[1, 0, 0],[0, 1, 0],[0, 0, 1]]
x1 = np.random.multivariate_normal([1,1,1], mat2, 10)
data1 = np.random.multivariate_normal([0,0,0], mat1, 50)


seed=1




def test_fun(function):
	if function=="simplical":
		print("s1-20")
		print(simplical(x, data,1,20))
		print("s0-0.05")
		print(simplical(x, data,0,0.05))
		print("s0-200")
		print(simplical(x, data,0,200))
		print("s1-0.05")	
		print(simplical(x, data,1,0.05))
	elif function=="simplicalVolume":
		print("simplicalVolume moment ")
		print(simplicalVolume(x,data))
		print("simplicalVolume MCD")
		print(simplicalVolume(x,data,mah_estimate="MCD", mah_parMCD=0.75))
		print("simplicalVolume none")
		print(simplicalVolume(x,data,mah_estimate="none", mah_parMCD=0.75))
	elif function=="mahalanobis":
		print("mahalanobis")
		print(mahalanobis(x,data))
		
	elif function=="potential":
		print("potential 1Mom 1")
		print(potential(x, data, pretransform = "1Mom", kernel=1))
		print("potential 1Mom 2")
		print(potential(x, data, pretransform = "1Mom", kernel=2))
		print("potential 1Mom 3")
		print(potential(x, data, pretransform = "1Mom", kernel=3))
		print("potential 1Mom 4")
		print(potential(x, data, pretransform = "1Mom", kernel=4))
		print("potential 1Mcd 1")
		print(potential(x, data, pretransform = "1MCD", kernel=1))
		print("potential 1Mcd 2")
		print(potential(x, data, pretransform = "1MCD", kernel=2))
		print("potential 1Mcd 3")
		print(potential(x, data, pretransform = "1MCD", kernel=3))
		print("potential 1Mcd 4")
		print(potential(x, data, pretransform = "1MCD", kernel=4))
		
	elif function=="halfspace":
		print('halfspace1')
		print(halfspace(x,data,method=1))
		print('halfspace2')
		print(halfspace(x,data,method=2))
		print('halfspace3')
		print(halfspace(x,data,method=3))
	elif function=="spatial":
		print('spatial')
		print(spatial(x,data))
	elif function=="zonoid":
		print('zonoid')
		print(zonoid(x,data))
	elif function=="qhpeeling":
		print('depth.qheeling')
		print(qhpeeling(x,data))
	elif function=="BetaSkeleton":
		print('Beta LP 1')
		print(BetaSkeleton(x, data, beta = 2, distance = "Lp", Lp_p = 1))
		print('Beta LP 2')
		print(BetaSkeleton(x, data, beta = 2, distance = "Lp", Lp_p = 2))
		print('Beta LP inf')
		print(BetaSkeleton(x, data, beta = 2, distance = "Lp", Lp_p = math.inf))
		print("Beta Maha none")
		print(BetaSkeleton(x, data, beta = 2, distance = "Mahalanobis", mah_estimate = "none", mah_parMcd = 0.75))
		print("Beta Maha Moment")
		print(BetaSkeleton(x, data, beta = 2, distance = "Mahalanobis", mah_estimate = "moment", mah_parMcd = 0.75))
		print("Beta Maha MCD")
		print(BetaSkeleton(x, data, beta = 2, distance = "Mahalanobis", mah_estimate = "MCD", mah_parMcd = 0.75))
		print('Beta LP 1 Beta =5 ')
		print(BetaSkeleton(x, data, beta = 5, distance = "Lp", Lp_p = 1))
		
	elif function=="L2":
		print("L2 moment")
		print(L2(x, data,'moment',0.75))
		print("L2 none")
		print(L2(x, data,'none',0.75))
		print("L2 MCD")
		print(L2(x, data,'MCD',0.75))
		print("L2 MCD 0.5")
		print(L2(x, data,'MCD',0.5))
		print("L2 error")
		print(L2(x, data,'test',0.75))
		
	else:
		print("bad arg function")
	return 1
	





x=np.array([[0.19419606, 0.097423  , 0.55522782],
       [0.75346671, 0.40357567, 0.6682322 ],
       [0.43210494, 0.16505737, 0.35164532],
       [0.68670453, 0.87598662, 0.18884185],
       [0.53424839, 0.48983636, 0.35331206],
       [0.39158775, 0.16526032, 0.30969399],
       [0.70503442, 0.21738926, 0.39223407],
       [0.84766878, 0.33219743, 0.14239219],
       [0.09114721, 0.46323964, 0.55343872],
       [0.59606966, 0.54707002, 0.54002657],
       [0.05907457, 0.84541262, 0.07980764],
       [0.8329732 , 0.55493081, 0.30258445],
       [0.9701691 , 0.08394051, 0.7850014 ],
       [0.52802061, 0.86425018, 0.23851544],
       [0.79289076, 0.4990698 , 0.95688314],
       [0.51506796, 0.78538039, 0.12242222],
       [0.69888905, 0.80579742, 0.90174754],
       [0.03291347, 0.2950742 , 0.83591958],
       [0.58538331, 0.30534015, 0.76165589],
       [0.8656121 , 0.45250885, 0.73642555]])
       
       
data=np.array([[0.1577361 , 0.8116313 , 0.65329291],
       [0.87974522, 0.52695798, 0.98312006],
       [0.08679148, 0.33069557, 0.94045799],
       [0.86463146, 0.6755113 , 0.30618616],
       [0.72847218, 0.37525818, 0.56666978],
       [0.08515504, 0.48551131, 0.49821361],
       [0.57142809, 0.0732545 , 0.88000986],
       [0.86914522, 0.80948713, 0.56855042],
       [0.58669355, 0.42286973, 0.4259361 ],
       [0.89371128, 0.8754814 , 0.33423511],
       [0.32132149, 0.90267397, 0.07197871],
       [0.87007885, 0.55244854, 0.49338562],
       [0.98618115, 0.82522146, 0.69166684],
       [0.22518499, 0.68716873, 0.19818139],
       [0.3237195 , 0.18101617, 0.97677048],
       [0.67323659, 0.33200978, 0.5061368 ],
       [0.9505607 , 0.76559188, 0.43214042],
       [0.13765831, 0.15315828, 0.98375367],
       [0.2252422 , 0.71475829, 0.09613276],
       [0.69542685, 0.51238154, 0.63002604],
       [0.19557513, 0.91036685, 0.91810945],
       [0.57171211, 0.33068873, 0.7474048 ],
       [0.15199103, 0.86919042, 0.83861875],
       [0.8088502 , 0.92609993, 0.15753605],
       [0.39353648, 0.92340205, 0.86098513],
       [0.28076159, 0.94851061, 0.96114227],
       [0.74388294, 0.82415998, 0.27334617],
       [0.69472599, 0.58532796, 0.22075117],
       [0.71480535, 0.40256053, 0.25369152],
       [0.98390197, 0.5991156 , 0.71249401],
       [0.96609186, 0.26557535, 0.4538134 ],
       [0.03958983, 0.03676095, 0.86171055],
       [0.88944387, 0.37801626, 0.03281983],
       [0.06368614, 0.59389065, 0.2450395 ],
       [0.48434702, 0.80882368, 0.9700938 ],
       [0.75562887, 0.78597738, 0.85254062],
       [0.35893499, 0.01961898, 0.40297214],
       [0.61312451, 0.24534097, 0.15496772],
       [0.3649997 , 0.9406249 , 0.58563873],
       [0.27890062, 0.43942068, 0.4592285 ],
       [0.20621375, 0.53463878, 0.24457229],
       [0.50823399, 0.28901158, 0.78746501],
       [0.96805958, 0.79718318, 0.38658559],
       [0.08785251, 0.97312973, 0.56907076],
       [0.94097545, 0.16076433, 0.88029486],
       [0.67893517, 0.54721709, 0.0224018 ],
       [0.12791094, 0.8849297 , 0.91458189],
       [0.26386377, 0.59703065, 0.62061813],
       [0.59762797, 0.39657442, 0.26214685],
       [0.18541412, 0.31182685, 0.18309883],
       [0.54216681, 0.17683868, 0.3286963 ],
       [0.50531   , 0.51616019, 0.91246994],
       [0.33223981, 0.80563183, 0.37663727],
       [0.29089804, 0.05958171, 0.76984749],
       [0.83883686, 0.11476923, 0.88964059],
       [0.61340273, 0.82014628, 0.20201902],
       [0.40289575, 0.04131658, 0.40553106],
       [0.00123289, 0.80654014, 0.56320378],
       [0.73810369, 0.30791033, 0.70142322],
       [0.3449702 , 0.24857007, 0.95543722],
       [0.27703688, 0.54740525, 0.64491547],
       [0.44925046, 0.01006816, 0.40627454],
       [0.81016323, 0.04514651, 0.0236456 ],
       [0.89467298, 0.72197522, 0.41641291],
       [0.97404562, 0.32102271, 0.31167222],
       [0.37246212, 0.60951407, 0.13540306],
       [0.21857802, 0.52309502, 0.46221999],
       [0.13087008, 0.14130806, 0.09212877],
       [0.13110895, 0.18476183, 0.6026936 ],
       [0.69411628, 0.93081977, 0.44001721],
       [0.37917638, 0.88279165, 0.70305464],
       [0.22069912, 0.48587945, 0.38023528],
       [0.67014094, 0.58545645, 0.45395995],
       [0.14272578, 0.67507642, 0.78232587],
       [0.19895996, 0.02184812, 0.81613126],
       [0.03936772, 0.03322298, 0.42181477],
       [0.92781189, 0.57602752, 0.09956789],
       [0.86226362, 0.88977414, 0.6417597 ],
       [0.42473088, 0.92383473, 0.91416385],
       [0.71249517, 0.99124559, 0.23701865],
       [0.48166714, 0.04976436, 0.29042505],
       [0.40423506, 0.99145931, 0.40197814],
       [0.74027517, 0.78480399, 0.33459845],
       [0.03225379, 0.45626561, 0.6084528 ],
       [0.54132113, 0.18986822, 0.78580803],
       [0.76250169, 0.68238877, 0.26007428],
       [0.43007724, 0.21009198, 0.03554553],
       [0.07339155, 0.27376936, 0.98304461],
       [0.86109291, 0.74907998, 0.93208509],
       [0.83848071, 0.00459688, 0.06261837],
       [0.36057148, 0.71037199, 0.73911338],
       [0.26713656, 0.36408124, 0.86562457],
       [0.51785098, 0.89752948, 0.2844165 ],
       [0.2707855 , 0.66195332, 0.18285696],
       [0.32203482, 0.01234577, 0.37375567],
       [0.59031965, 0.89325082, 0.08421084],
       [0.37420906, 0.87861806, 0.53106295],
       [0.54356167, 0.4566431 , 0.73663982],
       [0.85585871, 0.95360287, 0.3514987 ],
       [0.90425623, 0.71204199, 0.21498425],
       [0.72926104, 0.61806832, 0.65930265],
       [0.419008  , 0.26480864, 0.53212043],
       [0.46750331, 0.49974999, 0.25738544],
       [0.13895187, 0.26816418, 0.11752221],
       [0.15425251, 0.99906248, 0.91049763],
       [0.72310895, 0.56435217, 0.45317009],
       [0.76386975, 0.47167076, 0.12295862],
       [0.1001104 , 0.75932014, 0.47914893],
       [0.36260013, 0.9717886 , 0.60243336],
       [0.40510308, 0.62222987, 0.76463319],
       [0.88294462, 0.30705865, 0.73315646],
       [0.57750017, 0.19822648, 0.27792722],
       [0.98785805, 0.84651986, 0.26086554],
       [0.30673259, 0.4482873 , 0.43881691],
       [0.56241395, 0.72591484, 0.9919438 ],
       [0.84568721, 0.33107165, 0.44104784],
       [0.21889203, 0.47333039, 0.84218129],
       [0.75332413, 0.059259  , 0.33436098],
       [0.10827601, 0.74052024, 0.50555671],
       [0.71435241, 0.3302913 , 0.19297902],
       [0.75770979, 0.89623393, 0.23820119],
       [0.2692946 , 0.08120473, 0.54436244],
       [0.59250421, 0.4950946 , 0.97655193],
       [0.65043101, 0.15745878, 0.84219568],
       [0.70470075, 0.04416443, 0.06513532],
       [0.29220135, 0.23144475, 0.67269801],
       [0.19185088, 0.84773741, 0.18268142],
       [0.80252103, 0.57523512, 0.48489684],
       [0.6378836 , 0.14872516, 0.05842337],
       [0.93876493, 0.39270164, 0.86497908],
       [0.90171888, 0.97635951, 0.85353218],
       [0.91401078, 0.18389079, 0.21678798],
       [0.22757089, 0.17175996, 0.30643928],
       [0.24077067, 0.72942777, 0.31771428],
       [0.91466133, 0.48901126, 0.81650078],
       [0.74308667, 0.80784855, 0.9052665 ],
       [0.29399632, 0.95074238, 0.96355035],
       [0.41259214, 0.56987972, 0.07031679],
       [0.48312681, 0.5142399 , 0.54820771],
       [0.10457292, 0.66534746, 0.3002845 ],
       [0.32002568, 0.73515802, 0.77181854],
       [0.50692834, 0.32179342, 0.40291968],
       [0.712613  , 0.69930686, 0.24543098],
       [0.82235608, 0.82081601, 0.14683346],
       [0.57293812, 0.51155094, 0.26935649],
       [0.65666937, 0.24101036, 0.77260543],
       [0.50538661, 0.53514006, 0.79653438],
       [0.57149452, 0.41291127, 0.33245971],
       [0.30017868, 0.49658455, 0.01413737],
       [0.76291604, 0.59882709, 0.36681208],
       [0.85354775, 0.42528386, 0.6321582 ],
       [0.18393824, 0.50435125, 0.93445655],
       [0.25828496, 0.52072895, 0.3765224 ],
       [0.78093508, 0.5161056 , 0.21864462],
       [0.31192953, 0.19682504, 0.45611509],
       [0.18306366, 0.19212219, 0.69638086],
       [0.76988671, 0.44394616, 0.47032772],
       [0.44182245, 0.61172092, 0.95221538],
       [0.27753241, 0.12177265, 0.55658367],
       [0.77314707, 0.38305982, 0.4762895 ],
       [0.29806645, 0.04040906, 0.96938005],
       [0.55933131, 0.00809943, 0.2604702 ],
       [0.64255847, 0.75139939, 0.81449424],
       [0.4671531 , 0.6465774 , 0.32082957],
       [0.14817403, 0.99135974, 0.58251308],
       [0.624542  , 0.61996405, 0.12471826],
       [0.25382217, 0.50539642, 0.14478129],
       [0.18543236, 0.44880151, 0.18038043],
       [0.33696053, 0.25909822, 0.37826894],
       [0.45226241, 0.06357463, 0.22310025],
       [0.56322209, 0.17089957, 0.95176476],
       [0.93178341, 0.16442928, 0.60933285],
       [0.49451319, 0.32657204, 0.47445129],
       [0.56378082, 0.73565724, 0.42350526],
       [0.54616266, 0.22041953, 0.99852484],
       [0.91130754, 0.75950579, 0.32279982],
       [0.19792179, 0.30380837, 0.9224006 ],
       [0.0610446 , 0.46217176, 0.8068631 ],
       [0.6732297 , 0.42851344, 0.54151787],
       [0.21473222, 0.67237909, 0.80274073]])      
       


